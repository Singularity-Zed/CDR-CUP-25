<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Subscription Form with Card Check</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; background:#f6f7fb; display:flex; align-items:center; justify-content:center; height:100vh; }
    .card { background:#fff; padding:24px; border-radius:10px; width:350px; box-shadow:0 4px 15px rgba(0,0,0,.1); }
    h2 { margin-top:0; }
    .row { margin-bottom:12px; }
    label { display:block; margin-bottom:6px; font-size:.9rem; }
    input, select { width:100%; padding:10px; border:1px solid #ccc; border-radius:6px; font-size:1rem; }
    button { width:100%; padding:12px; border:none; border-radius:6px; background:#1f6fff; color:#fff; font-size:1rem; font-weight:bold; cursor:pointer; }
    button:hover { background:#1457d3; }
    .error { color:#b00020; font-size:.85rem; display:none; margin-top:6px; }
    .error.show { display:block; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Subscribe</h2>
    <form id="subscriptionForm" novalidate>
      <div class="row">
        <label for="name">Full Name</label>
        <input id="name" name="name" type="text" required />
      </div>
      <div class="row">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" required />
      </div>
      <div class="row">
        <label for="plan">Plan</label>
        <select id="plan" name="plan" required>
          <option value="" disabled selected>Choose a plan…</option>
          <option value="free">Free</option>
          <option value="standard">Standard</option>
          <option value="pro">Pro</option>
        </select>
      </div>
      <div class="row">
        <label for="card">Credit Card Number</label>
        <input id="card" name="card" type="text" inputmode="1234123412341234" placeholder="1234 5678 9012 3456" required />
        <div id="cardError" class="error">Invalid credit card number.</div>
      </div>
      <button type="submit">Subscribe</button>
    </form>
  </div>

  <script>
    const REDIRECT_URL = 'file:///C:\CDR-CUP\LocalBackup\creds.html'; // change this

    const form = document.getElementById("subscriptionForm");
    const cardInput = document.getElementById("card");
    const cardError = document.getElementById("cardError");

    // Luhn check
    function validCard(number) {
      number = number.replace(/\D/g, "");
      let sum = 0;
      let shouldDouble = false;
      for (let i = number.length - 1; i >= 0; i--) {
        let digit = parseInt(number.charAt(i), 10);
        if (shouldDouble) {
          digit *= 2;
          if (digit > 9) digit -= 9;
        }
        sum += digit;
        shouldDouble = !shouldDouble;
      }
      return sum % 10 === 0;
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      cardError.classList.remove("show");

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      if (!validCard(cardInput.value)) {
        cardError.classList.add("show");
        cardInput.focus();
        return;
      }

      // ✅ All fields valid and card number correct
      window.location.href = REDIRECT_URL;
    });
  </script>
</body>
</html>
